см картинки про установке в переписке slack за 23.02


УСТАНОВКА

В папке .../glpi/plugins создать папку glpimobilenotification. 
В этой папке создать папку /inc

в папку glpimobilenotification записать файлы:
setup.php
hook.php
glpimobilenotification.cfg (новая версия)
install.php (новая версия)
uninstall.php (новая версия)

в папку glpimobilenotification/inc записать файл:
event.class.php

Под супер админом зайти в настройки / плагины. В списке должен появиться плагин Glpi mobile notification. Его надо установить и включить. 
При установке:
 в таблице glpi_users будет создано поле mobile_notification
 будет создана новая таблица glpi_plugin_glpimobilenotification_config, в которую будут записаны параметры из файла glpimobilenotification.cfg

firebase_url - url сервиса Firebase messaging
api_key - ключ приложения, выдаваемый при регистрации приложения в Firebase
api_key_android - Server key для android приложения, выдаваемый при регистрации приложения в Firebase
api_key_ios - Server key для ios приложения, выдаваемый при регистрации приложения в Firebase
message_title - название источника уведомления, показываемое в уведомлении на телефоне
message_lang - если указано rus, то уведомление на русском, иначе - на английском 
actor_types - тип пользователей, которым рассылаеются уведомление о private комментарии (в поле type в таблице glpi_tickets_users). Формат: type1, type2, ...
admin_profiles - id профиля пользователей, имеющих права admin и super_admin (в поле profiles_id в таблице glpi_profiles_users). Формат: id1, id2, ...
write_log -  1 - писать информацию об отправленных уведомлениях в файл .../glpi/plugin/glpimobilenotification/glpimobilenotification.log

для изменения параметров необходимо внести изменения в этот файл и переустановить плагин

РАБОТА

Плагин отправляет уведомления тем пользователям, у кого в поле mobile_notification записан токен. Запись в поле mobile_notification  делает приложение на телефоне, если в его настройках установлено получать push уведомления. 

Уведомления отправляются:

- при создании новой ЗАЯВКИ:

	- пользователям с профилем из списка в параметре admin_profiles (3-admin, 4-super-admin), указанным в разрешениях для организации, по которой создана заявка, или ее вышестоящим организациям. 
	- пользователям, указанным в качеcтве исполнителей и наблюдателей ПРИ СОЗДАНИИ ЗАЯВКИ 
	- уведомление автору заявки не отправляется.


- при создании КОММЕНТАРИЯ к заявке:

	- пользователям с профилем из списка в параметре admin_profiles, указанным в разрешениях для организации, по которой создана заявка, или ее вышестоящим организациям. 
	- пользователям, указанным в заявке в качеcтве автора, исполнителей и наблюдателей НА МОМЕНТ СОЗДАНИЯ КОММЕНТАРИЯ. Если комментарий помечен как private, то уведомление отправляется только пользователям с типом из списка в параметре actor_types (1-автор заявки, 2-исполнитель, 3- наблюдатель) в glpimobilenotification.cfg. 
	- уведомление автору комментария не отправляется.
	